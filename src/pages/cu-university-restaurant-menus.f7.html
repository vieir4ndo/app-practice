<template>
	<div class="page" data-name="cu-university-restaurant-menus">
		<div class="navbar">
			<div class="navbar-bg"></div>
			<div class="navbar-inner sliding">
				<!-- Link to go back -->
				<div class="left">
					<a href="/" class="link back">
						<i class="icon icon-back"></i>
						<span class="if-not-md">Voltar</span>
					</a>
				</div>
				<div class="title">Restaurante Universitário</div>
			</div>
		</div>

		<div class="page-content">
			<div id="menus" class="block display-flex align-items-center justify-content-center">
				<div id="lottie-text">
					<h2 class="no-margin">Cardápios</h2>
				</div>
				<div>
					<lottie-player src="../static/lottie/cu-university-restaurant-menus.json" loop autoplay>
					</lottie-player>
				</div>
			</div>

			<div class="menus-list block">
				{{#if menus}}
					{{#each menus}}
						<div class="menu">
							<div class="block-title">
								<h3>{{ this.date }}</h3>
							</div>
							<div class="block block-strong">
								<ul>
									<li>{{ this.salad_1       }}</li>
									<li>{{ this.salad_2       }}</li>
									<li>{{ this.salad_3       }}</li>
									<li>{{ this.grains_1      }}</li>
									<li>{{ this.grains_2      }}</li>
									<li>{{ this.grains_3      }}</li>
									<li>{{ this.side_dish     }}</li>
									<li>{{ this.mixture       }}</li>
									<li>{{ this.vegan_mixture }}</li>
									<li>{{ this.dessert       }}</li>
								</ul>
							</div>
						</div>
					{{/each}}
				{{else}}
					<p style="text-align: center;">
						Poxa! Ainda não há cardápios cadastrados.
					</p>
				{{/if}}
			</div>
		</div>
	</div>
</template>
<style>
	#menus lottie-player {
		height: 130px;
	}

	.menus-list .block-title {
		font-size: 1rem;
		text-align: center;
		margin: auto;
	}
</style>
<script>
	export default {
		data: function () {
			return {
				menus: null
			}
		},
		on: {
			pageInit: function () {
				this.loadMenus();
			}
		},
		methods: {
			loadMenus() {
				let app = this.$app;
				this.$setState({
					menus: null,
				});
				app.api.getMenus().then(menus => {

					menus.map(menu => {
						let formattedDate = new Date(menu.date).toLocaleDateString('pt-BR');
						menu.date = formattedDate;
					})

					this.$setState({
						menus: menus,
					});
				})
			}
		}
	}
</script>