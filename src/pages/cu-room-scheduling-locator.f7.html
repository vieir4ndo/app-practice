<template>
	<div class="page" data-name="cu-room-scheduling-locator">

		<div class="navbar">
			<div class="navbar-bg"></div>
			<div class="navbar-inner sliding">
				<!-- Link to go back -->
				<div class="left">
					<a href="/" class="link back">
						<i class="icon icon-back"></i>
						<span class="if-not-md">Voltar</span>
					</a>
				</div>
				<div class="title">Agendamento de Salas</div>
			</div>
		</div>

		<div class="page-content">
			<div id="lottie" class="block display-flex align-items-center">
				<div id="lottie-text">
					<h2 class="no-margin">Agendamentos</h2>
				</div>
				<div>
					<lottie-player src="../static/lottie/cu-room-scheduling-locator.json" loop autoplay>
					</lottie-player>
				</div>
			</div>
			<div class="list simple-list">
				<ul class="roomScheduling">
					{{#if reserves}}
						{{#unless reserves.length}}
								<li class="item-content">
									<div class="item-inner">
										<div class="item-title">VocÃª ainda nÃ£o fez agendamentos ðŸ˜¥</div>
										<div class="item-text no-wrap">
											<p>Agende uma sala agora mesmo!</p>
										</div>
									</div>
								</li>
							{{else}}
								{{#each reserves}}
										<li class="item-content" style="border-left: solid 10px green;" @click="detailsRoomSchedule()">
											<div class="item-inner">
												<div class="item-title-row">
													<div class="item-title">
														<div><b>{{this.room}}</b></div>
														{{#if this.ccr}}
														<span class="badge color-orange">{{this.ccr}}</span>
														{{/if}}
													</div>
												</div>
												<div class="item-text no-wrap">
													<div><b>{{this.begin}}</b></div>
												</div>
											</div>
										</li>
								{{/each}}
						{{/unless}}
					{{else}}
					{{#each '123'}}
							<li class="item-content skeleton-text skeleton-effect-blink">
								<div class="item-inner">
									<div class="item-title-row">
										<div class="item-title">
											<div><b>________</b></div>
											<span>_________</span>
										</div>
									</div>
									<div class="item-text no-wrap">
										<div><b>___________________</b></div>
									</div>
								</div>
							</li>
					{{/each}}
					{{/if}}
<!--					<li class="item-content" style="border-left: solid 10px green;" @click="detailsRoomSchedule()">-->
<!--						<div class="item-inner">-->
<!--							<div class="item-title-row">-->
<!--								<div class="item-title">-->
<!--									<div><b>Sala 404</b></div>-->
<!--									<span class="badge color-orange">CC-GEX613</span>-->
<!--								</div>-->
<!--							</div>-->
<!--							<div class="item-text no-wrap"><b>03/08 19h10 - 22h40</b></div>-->
<!--						</div>-->
<!--					</li>-->
<!--					<li class="item-content" style="border-left: solid 10px #FCAE17;" @click="detailsRoomSchedule()">-->
<!--						<div class="item-inner">-->
<!--							<div class="item-title-row">-->
<!--								<div class="item-title">-->
<!--									<div><b>Sala 403</b></div>-->
<!--									<span class="badge color-orange">CC-GEX613</span>-->
<!--								</div>-->
<!--							</div>-->
<!--							<div class="item-text no-wrap">03/08 13h30 - 18h00</div>-->
<!--						</div>-->
<!--					</li>-->
<!--					<li class="item-content" style="border-left: solid 10px rgb(218, 36, 36);" @click="detailsRoomSchedule()">-->
<!--						<div class="item-inner">-->
<!--							<div class="item-title-row">-->
<!--								<div class="item-title">-->
<!--									<div><b>Sala 403</b></div>-->
<!--									<span class="badge color-orange">CC-GEX613</span>-->
<!--								</div>-->
<!--							</div>-->
<!--							<div class="item-text no-wrap">02/08 13h30 - 18h00</div>-->
<!--						</div>-->
<!--					</li>-->
				</ul>
			</div>
		</div>

		<div class="fab fab-right-bottom color-orange">
			<a href="#">
				<i class="icon f7-icons if-not-md">plus</i>
				<i class="icon f7-icons if-not-md">xmark</i>
				<i class="icon material-icons md-only">add</i>
				<i class="icon material-icons md-only">close</i>
			</a>
			<div class="fab-buttons fab-buttons-top">
				<a class="fab-label-button" href="/cu/room-scheduling/responsible/">
					<span><i class="icon f7-icons">chat_bubble_fill</i></span>
					<span class="fab-label">SolicitaÃ§Ãµes</span>
				</a>
				<a class="fab-label-button" href="/cu/room-scheduling/schedule/">
					<span><i class="icon material-icons">add</i></span>
					<span class="fab-label">Novo Agendamento</span>
				</a>
			</div>
		</div>

		<div class="popup display-flex flex-direction-column-reverse" id="cu-room-scheduling-locator-popup" style="background: none;">
			<div class="block bg-white padding no-margin display-flex flex-direction-column justify-content-space-between"
					 style="height: 60vh; background-color: white;">
				<div class="block no-margin">
					<h2>Sala 403</h2>
					<div>ResponsÃ¡vel pela Sala: DÃªnio Duarte</div>
					<div>Status do Agendamento: <b>Pendente</b></div>
					<hr class="margin-vertical">
					<div class="text-align-right">InÃ­cio da Reserva: <b>03/08/2022 - 13h30</b></div>
					<div class="text-align-right">Fim da Reserva: <b>03/08/2022 - 18h00</b></div>
					<div class="margin-vertical padding-vertical">CCR vinculado: <b>CC-GEX613</b></div>
					<div><b>ObservaÃ§Ãµes: </b></div>
					<textarea rows="4"
										style="width: 100%;">Reserva referente a uma atividade prÃ¡tica de Geometria AnalÃ­tica com o 4Âº Semestre de CiÃªncia da computaÃ§Ã£o, utilizaremos o GeoGebra web.</textarea>
				</div>
				<button class="align-self-flex-end button button-fill color-red margin-top">
					Cancelar Agendamento
				</button>
			</div>
		</div>
	</div>
</template>
<style>
    .roomScheduling .item-content {
        line-height: normal;
        height: 100px;
    }

    /* Striped List */
    .roomScheduling .item-content:nth-child(even) {
        background-color: rgb(230, 230, 230);
    }

    .cu-room-scheduling-filter input {
        width: 100px;
        margin-left: 5px;
        font-weight: bold;
    }
</style>
<script>
    export default {
        data: function () {
            return {
                reserves: null,
            }
        },
        on: {
            pageInit: function () {
                this.loadReserves();
            }
        },
        methods: {
            detailsRoomSchedule() {
                let app = this.$app;

                let popup = app.popup.create({
                    swipeToClose: 'to-bottom',
                    closeByBackdropClick: true,
                    el: app.$$('#cu-room-scheduling-locator-popup'),
                })
                popup.open();
            },
            loadReserves() {
                let app = this.$app;
                app.api.getReserves().then(reserves => {
                    this.$setState({
                        reserves: reserves,
                    });
                })
            }
        }
    }
</script>